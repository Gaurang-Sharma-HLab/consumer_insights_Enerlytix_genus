<app-base-page-layout pageTitle="Power Quality">
  <!-- Topic 1: Outage Monitoring & Analysis Report -->
  <app-topic-section title="Outage Monitoring & Analysis Report: Consumer-Level Frequent Outage Monitoring & Forecasting" [topicNumber]="1" (opened)="onTopicSectionOpened($event)">
    <app-summary-tiles [data]="outageSummary"></app-summary-tiles>
    <div class="space-y-4">
      <h3 class="text-md font-semibold" [style.color]="'var(--text-primary)'">1.1 Outage Interval Definitions (Configurable)</h3>
      <app-data-table [data]="getOutageIntervalsWithIds()" [columns]="outageIntervalColumns"></app-data-table>
    </div>
    <div class="space-y-4">
      <h3 class="text-md font-semibold" [style.color]="'var(--text-primary)'">1.2 Historical Outage Trends (Last 7 Days)</h3>
      <app-data-table [data]="outageHistorical" [columns]="outageHistoricalColumns"></app-data-table>
    </div>
    <div class="space-y-4">
      <h3 class="text-md font-semibold" [style.color]="'var(--text-primary)'">1.3 Forecasted Outage Trends (Next Month)</h3>
      <app-data-table [data]="outageForecast" [columns]="outageForecastColumns"></app-data-table>
    </div>
    <div class="space-y-4">
      <h3 class="text-md font-semibold" [style.color]="'var(--text-primary)'">1.4 Consumer Segment-wise Outage Impact</h3>
      <app-data-table [data]="getOutageSegmentsWithIds()" [columns]="outageSegmentColumns"></app-data-table>
    </div>
  </app-topic-section>

  <!-- Topic 2: Voltage Deviation Index (VDI) Analysis & Forecasting Report -->
  <app-topic-section title="Voltage Deviation Index (VDI) Analysis & Forecasting Report" [topicNumber]="2" (opened)="onTopicSectionOpened($event)">
    <app-summary-tiles [data]="voltageDeviationSummary"></app-summary-tiles>
    <div class="space-y-4">
      <h3 class="text-md font-semibold" [style.color]="'var(--text-primary)'">2.1 Voltage Monitoring Interval Definitions (Configurable)</h3>
      <app-data-table [data]="getVoltageIntervalsWithIds()" [columns]="voltageIntervalColumns"></app-data-table>
    </div>
    <div class="space-y-4">
      <h3 class="text-md font-semibold" [style.color]="'var(--text-primary)'">2.2 Historical Voltage Deviation Trends (Last 7/30 Days)</h3>
      <app-data-table [data]="voltageHistorical" [columns]="voltageHistoricalColumns"></app-data-table>
    </div>
    <div class="space-y-4">
      <h3 class="text-md font-semibold" [style.color]="'var(--text-primary)'">2.3 Forecasted Voltage Deviation Risk (Next Month)</h3>
      <app-data-table [data]="voltageForecast" [columns]="voltageForecastColumns"></app-data-table>
    </div>
    <div class="space-y-4">
      <h3 class="text-md font-semibold" [style.color]="'var(--text-primary)'">2.4 Voltage Deviation by Consumer Segment</h3>
      <app-data-table [data]="getVoltageSegmentsWithIds()" [columns]="voltageSegmentColumns"></app-data-table>
    </div>
  </app-topic-section>

  <!-- Topic 3: Frequency Deviation Index (F-DI) Analysis & Forecasting Report -->
  <app-topic-section title="Frequency Deviation Index (F-DI) Analysis & Forecasting Report" [topicNumber]="3" (opened)="onTopicSectionOpened($event)">
    <app-summary-tiles [data]="frequencyDeviationSummary"></app-summary-tiles>
    <div class="space-y-4">
      <h3 class="text-md font-semibold" [style.color]="'var(--text-primary)'">3.1 Data Selection Parameters</h3>
      <div class="bg-card border rounded-xl p-4" [style.border-color]="'var(--border-color)'" [style.background-color]="'var(--bg-card)'">
        <ul class="space-y-2" [style.color]="'var(--text-secondary)'">
          <li><strong [style.color]="'var(--text-primary)'">From & To Date</strong> – [DD-MM-YYYY to DD-MM-YYYY]</li>
          <li><strong [style.color]="'var(--text-primary)'">Circle / Division / Sub-division</strong> – [Specify here]</li>
          <li><strong [style.color]="'var(--text-primary)'">Radio Button Selection</strong> – Feeder / DT</li>
        </ul>
      </div>
    </div>
    <div class="space-y-4">
      <h3 class="text-md font-semibold" [style.color]="'var(--text-primary)'">3.2 Frequency Deviation Blocks (Configurable)</h3>
      <app-data-table [data]="getFrequencyBlocksWithIds()" [columns]="frequencyBlockColumns"></app-data-table>
    </div>
    <div class="space-y-4">
      <h3 class="text-md font-semibold" [style.color]="'var(--text-primary)'">3.3 Historical Frequency Deviation Trends (Last 7/30 Days)</h3>
      <app-data-table [data]="frequencyHistorical" [columns]="frequencyHistoricalColumns"></app-data-table>
    </div>
    <div class="space-y-4">
      <h3 class="text-md font-semibold" [style.color]="'var(--text-primary)'">3.4 Forecasted Frequency Performance (Next Month)</h3>
      <app-data-table [data]="frequencyForecast" [columns]="frequencyForecastColumns"></app-data-table>
    </div>
    <div class="space-y-4">
      <h3 class="text-md font-semibold" [style.color]="'var(--text-primary)'">3.5 Equipment Type-wise Frequency Deviation Analysis</h3>
      <app-data-table [data]="getFrequencyEquipmentTypesWithIds()" [columns]="frequencyEquipmentTypeColumns"></app-data-table>
    </div>
  </app-topic-section>

  <!-- Topic 4: Low Power Factor Analysis & Forecasting Report– System Meters (DT/Feeder) -->
  <app-topic-section title="Low Power Factor Analysis & Forecasting Report– System Meters (DT/Feeder)" [topicNumber]="4" (opened)="onTopicSectionOpened($event)">
    <app-summary-tiles [data]="systemPowerFactorSummary"></app-summary-tiles>
    <div class="space-y-4">
      <h3 class="text-md font-semibold" [style.color]="'var(--text-primary)'">4.1 Analysis Parameters (Configurable)</h3>
      <div class="bg-card border rounded-xl p-4" [style.border-color]="'var(--border-color)'" [style.background-color]="'var(--bg-card)'">
        <ul class="space-y-2" [style.color]="'var(--text-secondary)'">
          <li><strong [style.color]="'var(--text-primary)'">From & To Date:</strong> [DD-MM-YYYY – DD-MM-YYYY]</li>
          <li><strong [style.color]="'var(--text-primary)'">Geographical Filters:</strong> Circle / Division / Sub-division</li>
          <li><strong [style.color]="'var(--text-primary)'">Selection Mode:</strong> Radio button – Feeder / DT</li>
        </ul>
      </div>
    </div>
    <div class="space-y-4">
      <h3 class="text-md font-semibold" [style.color]="'var(--text-primary)'">4.2 Historical Low PF Trends (Last 7 Days)</h3>
      <app-data-table [data]="systemPowerFactorHistorical" [columns]="systemPowerFactorHistoricalColumns"></app-data-table>
    </div>
    <div class="space-y-4">
      <h3 class="text-md font-semibold" [style.color]="'var(--text-primary)'">4.3 Forecasted Risk (Next Month)</h3>
      <app-data-table [data]="systemPowerFactorForecast" [columns]="systemPowerFactorForecastColumns"></app-data-table>
    </div>
    <div class="space-y-4">
      <h3 class="text-md font-semibold" [style.color]="'var(--text-primary)'">4.4 Consumer Segment-wise PF Issues</h3>
      <app-data-table [data]="getSystemPowerFactorSegmentsWithIds()" [columns]="systemPowerFactorSegmentColumns"></app-data-table>
    </div>
  </app-topic-section>
</app-base-page-layout>
