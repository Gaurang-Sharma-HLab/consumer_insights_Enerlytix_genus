<app-base-page-layout pageTitle="Forecasting">
  <!-- Topic 1: Load Forecasting Report -->
  <app-topic-section title="Load Forecasting Report: Load Forecasting & Consumer Usage Behavior Categorization" [topicNumber]="1" (opened)="onTopicSectionOpened($event)">
    <app-summary-tiles [data]="loadForecastSummary"></app-summary-tiles>
    <div class="space-y-4">
      <h3 class="text-md font-semibold" [style.color]="'var(--text-primary)'">1.1 Load Forecast Summary – By Consumer Category</h3>
      <app-data-table [data]="getLoadForecastByCategoryWithIds()" [columns]="loadForecastByCategoryColumns"></app-data-table>
    </div>
    <div class="space-y-4">
      <h3 class="text-md font-semibold" [style.color]="'var(--text-primary)'">1.2 Consumer Behavior-Based Categorization</h3>
      <div class="bg-card border rounded-xl p-4 mb-4" [style.border-color]="'var(--border-color)'" [style.background-color]="'var(--bg-card)'">
        <h4 class="text-sm font-semibold mb-2" [style.color]="'var(--text-primary)'">Category Definitions:</h4>
        <ul class="space-y-1 text-sm" [style.color]="'var(--text-secondary)'">
          <li><strong>Peak-Heavy</strong> – >70% of usage during 6–10 PM or 10–2 PM</li>
          <li><strong>Solar User</strong> – Consistently low grid import during daylight</li>
          <li><strong>Low-User</strong> – <2 kWh/day for 3+ consecutive months</li>
          <li><strong>Night Peak</strong> – >50% of energy consumed during 8 PM–6 AM</li>
        </ul>
      </div>
      <app-data-table [data]="getConsumerBehaviorCategoriesWithIds()" [columns]="consumerBehaviorCategoryColumns"></app-data-table>
    </div>
    <app-insights-card [insights]="[
      'Targeted load management during festive evening peaks',
      'Shift peak-heavy users with ToD (Time of Day) pricing',
      'Promote solar + battery to reduce peak imports in commercial sectors',
      'Flag low-user/idle meters for usage verification or deactivation',
      'Expand EV charging support during night valleys (8 PM–4 AM)'
    ]"></app-insights-card>
  </app-topic-section>

  <!-- Topic 2: ToD-wise Consumption Analysis & Forecasting Report -->
  <app-topic-section title="ToD-wise Consumption Analysis & Forecasting Report: ToD-wise Consumption Analysis and Forecasting" [topicNumber]="2" (opened)="onTopicSectionOpened($event)">
    <app-summary-tiles [data]="todSummary"></app-summary-tiles>
    <div class="space-y-4">
      <h3 class="text-md font-semibold" [style.color]="'var(--text-primary)'">2.1 ToD Interval Definitions (Configurable)</h3>
      <app-data-table [data]="getTodIntervalsWithIds()" [columns]="todIntervalColumns"></app-data-table>
    </div>
    <div class="space-y-4">
      <h3 class="text-md font-semibold" [style.color]="'var(--text-primary)'">2.2 Historical ToD Consumption Trends (Last 7/30 Days)</h3>
      <app-data-table [data]="todHistorical" [columns]="todHistoricalColumns"></app-data-table>
    </div>
    <div class="space-y-4">
      <h3 class="text-md font-semibold" [style.color]="'var(--text-primary)'">2.3 Forecasted Energy Requirement (Next Month)</h3>
      <app-data-table [data]="todForecast" [columns]="todForecastColumns"></app-data-table>
    </div>
    <div class="space-y-4">
      <h3 class="text-md font-semibold" [style.color]="'var(--text-primary)'">2.4 Consumer Segment-wise ToD Behavior Analysis</h3>
      <app-data-table [data]="getTodSegmentsWithIds()" [columns]="todSegmentColumns"></app-data-table>
    </div>
  </app-topic-section>
</app-base-page-layout>
